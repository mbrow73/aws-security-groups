# AWS Security Group Platform - Template Configuration
# Copy this file and customize it for your account
#
# REQUIRED CHANGES:
# 1. Replace YOUR_ACCOUNT_ID with your actual 12-digit AWS account ID
# 2. Update the environment to match your environment
# 3. Update the Team tag to your team name
# 4. Add your security groups configuration below

# Required: Your 12-digit AWS Account ID
account_id: "YOUR_ACCOUNT_ID"  # <-- REPLACE WITH YOUR ACCOUNT ID

# Required: Environment designation
environment: "production"  # <-- UPDATE: production, staging, development

# Optional: VPC configuration (if you need to target a specific VPC)
vpc:
  # Set to "auto" for automatic VPC discovery (recommended)
  # Set to specific VPC ID if you have multiple VPCs
  vpc_id: "auto"
  
  # Optional: Tags to help with VPC discovery
  # filter_tags:
  #   Environment: "production"
  #   Name: "*main*"
  
  # Optional: VPC requirements for validation
  # require_internet_access: true
  # require_private_subnets: true
  # min_availability_zones: 2

# Required: Global tags applied to all security groups
tags:
  Team: "YOUR_TEAM_NAME"  # <-- REPLACE WITH YOUR TEAM NAME
  # Add other tags as needed:
  # CostCenter: "engineering"
  # Project: "migration"

# Optional: Baseline security group profiles
# Uncomment the ones you need:
baseline_profiles:
  # - vpc-endpoints      # Secure access to AWS services (S3, ECR, etc.)
  # - internet-ingress   # WAF/CDN â†’ NLB traffic (Cloudflare, Fastly, etc.)
  # - eks-standard       # EKS cluster and node communication

# Your security groups configuration
security_groups:
  
  # Example 1: Web application security group
  web-app:
    description: "Security group for web application servers"
    
    tags:
      Application: "web-app"
      Tier: "application"
      
    ingress:
      # HTTP from ALB
      - protocol: "tcp"
        from_port: 8080
        to_port: 8080
        security_groups: ["alb-web-production"]  # Reference to ALB security group
        description: "HTTP from Application Load Balancer"
        
      # Health checks
      - protocol: "tcp"
        from_port: 8081
        to_port: 8081
        security_groups: ["alb-web-production"]
        description: "Health check endpoint"
        
    egress:
      # Database access
      - protocol: "tcp"
        from_port: 5432
        to_port: 5432
        security_groups: ["database-production"]
        description: "PostgreSQL database access"
        
      # External API calls
      - protocol: "tcp"
        from_port: 443
        to_port: 443
        cidr_blocks: ["0.0.0.0/0"]
        description: "HTTPS outbound for API calls"

  # Example 2: Database security group  
  database:
    description: "PostgreSQL database security group"
    
    tags:
      Application: "database"
      Tier: "database"
      
    ingress:
      # PostgreSQL from application servers
      - protocol: "tcp"
        from_port: 5432
        to_port: 5432
        security_groups: ["web-app"]  # Reference to the web-app SG above
        description: "PostgreSQL from application servers"
    
    # No egress rules = default allow all outbound (for managed RDS)

# Additional examples (commented out - uncomment and customize as needed):

  # # Load Balancer Security Group
  # alb-web-production:
  #   description: "Application Load Balancer for web services"
  #   
  #   tags:
  #     Application: "alb"
  #     Tier: "load-balancer"
  #     
  #   ingress:
  #     # HTTPS from internet (through WAF)
  #     - protocol: "tcp"
  #       from_port: 443
  #       to_port: 443
  #       prefix_list_ids: ["waf-saas-providers"]  # From prefix-lists.yaml
  #       description: "HTTPS from WAF providers"
  #       
  #     # HTTP redirect
  #     - protocol: "tcp"
  #       from_port: 80
  #       to_port: 80
  #       prefix_list_ids: ["waf-saas-providers"]
  #       description: "HTTP redirect from WAF providers"

  # # EKS Worker Nodes
  # eks-workers:
  #   description: "EKS worker nodes security group"
  #   
  #   tags:
  #     Application: "kubernetes"
  #     Tier: "compute"
  #     
  #   ingress:
  #     # Node-to-node communication
  #     - protocol: "tcp"
  #       from_port: 0
  #       to_port: 65535
  #       self: true
  #       description: "Inter-node communication"
  #       
  #     # Kubelet API from control plane
  #     - protocol: "tcp"
  #       from_port: 10250
  #       to_port: 10250
  #       security_groups: ["eks-control-plane"]
  #       description: "Kubelet API from EKS control plane"
  #       
  #   egress:
  #     # HTTPS for pulling images
  #     - protocol: "tcp"
  #       from_port: 443
  #       to_port: 443
  #       cidr_blocks: ["0.0.0.0/0"]
  #       description: "HTTPS for pulling container images"
  #       
  #     # DNS resolution
  #     - protocol: "tcp"
  #       from_port: 53
  #       to_port: 53
  #       cidr_blocks: ["0.0.0.0/0"]
  #       description: "DNS TCP"
  #       
  #     - protocol: "udp"
  #       from_port: 53
  #       to_port: 53
  #       cidr_blocks: ["0.0.0.0/0"]
  #       description: "DNS UDP"