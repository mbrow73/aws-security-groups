# AWS Security Group Platform - Example Configuration
# Copy to accounts/<your-account-id>/security-groups.yaml

account_id: "123456789012"
environment: "prod"  # prod | test | dev

# Baseline profiles (optional) â€” pre-built zero-trust SG sets
# eks-standard:  Intranet-only EKS (auto-deploys vpc-endpoints)
# eks-internet:  Internet + intranet EKS (auto-deploys vpc-endpoints)
# vpc-endpoints: Standalone VPC endpoint access
# Note: eks-standard and eks-internet are mutually exclusive
baseline_profiles:
  - eks-standard

# Custom security groups
security_groups:

  # Example: Application behind NLB
  app-backend:
    description: "Backend API service"
    tags:
      "<company>-app-env": "prod"
      "<company>-data-classification": "internal"
      "<company>-app-carid": "600001725"
      "<company>-ops-supportgroup": "Security_Operations_Support"
      "<company>-app-supportgroup": "Security_Operations_Support"
      "<company>-provisioner-repo": "placeholder"
      "<company>-iam-access-control": "netsec"
      "<company>-provisioner-workspace": "600001725-prod-sg-123456789012"
    ingress:
      - protocol: "tcp"
        from_port: 8080
        to_port: 8080
        security_groups: ["sg-0123456789abcdef0"]
        description: "HTTP from ALB"
      - protocol: "tcp"
        from_port: 9090
        to_port: 9090
        cidr_blocks: ["10.160.0.0/16"]
        description: "Prometheus scraping"
    egress:
      - protocol: "tcp"
        from_port: 5432
        to_port: 5432
        security_groups: ["rds-postgres"]
        description: "PostgreSQL access"
      - protocol: "tcp"
        from_port: 443
        to_port: 443
        prefix_list_ids: ["corporate-networks"]
        description: "On-prem services via TGW"
      - protocol: "udp"
        from_port: 53
        to_port: 53
        cidr_blocks: ["10.0.0.0/8"]
        description: "DNS resolution"

  # Example: Database (restrictive)
  rds-postgres:
    description: "PostgreSQL RDS"
    tags:
      "<company>-app-env": "prod"
      "<company>-data-classification": "internal"
      "<company>-app-carid": "600001725"
      "<company>-ops-supportgroup": "Security_Operations_Support"
      "<company>-app-supportgroup": "Security_Operations_Support"
      "<company>-provisioner-repo": "placeholder"
      "<company>-iam-access-control": "netsec"
      "<company>-provisioner-workspace": "600001725-prod-sg-123456789012"
    ingress:
      - protocol: "tcp"
        from_port: 5432
        to_port: 5432
        security_groups: ["app-backend"]
        description: "PostgreSQL from app servers"
